# Part a
rmvn.Choleski = function(n, mu, Sigma) {
  d = length(mu)
  Q = chol(Sigma)
  Z = matrix(rnorm(n*d), nrow=n, ncol=d)
  X = Z %*% Q + matrix(mu,n,d,byrow=T)
  X
}

mu = c(30,40,10,16,40,20,70,50,10,50,90,80)
Sigma = matrix(c(1,  0.9,0.8,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.1,0.1, 
           
           0.9, 1,  0.8,0.8,0.8,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
           
           0.8,0.8, 1  ,0.9,0.8,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
           
           0.9,0.8,0.9, 1,   0.8,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
           
           0.9,0.8,0.8,0.8, 1  ,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
           
           0.1,0.1,0.1,0.1,0.1,  1, 0.8,0.9, 0.1,0.1,0.1,0.1,
           
           0.1,0.1,0.1,0.1,0.1,0.8, 1,  0.9,0.1,0.1,0.1,0.1, 
           
           0.1,0.1,0.1,0.1,0.1,0.9,0.9, 1, 0.1,0.1,0.1,0.1,
           
           0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,  1 ,0.9,0.9,0.9,
           
           0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1, 0.9 ,1, 0.9,0.9, 
           
           0.1,0.1,0.1,0.1,0.1,0.1, 0.1,0.1,0.9,0.9,1,0.9,
           
           0.1,0.1,0.1,0.1,0.1,0.1, 0.1,0.1, 0.9,0.9,0.9,1), ncol=12, nrow=12, byrow=T)

X = rmvn.Choleski(2000, mu, Sigma)

# Part b
pairs(X, labels=c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"), lower.panel=NULL)

# Part c
write.csv(X, file="MVNdata1.csv")